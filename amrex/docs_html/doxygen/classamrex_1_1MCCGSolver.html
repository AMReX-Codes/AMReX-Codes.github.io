<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AMReX: amrex::MCCGSolver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMReX
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceamrex.html">amrex</a></li><li class="navelem"><a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classamrex_1_1MCCGSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">amrex::MCCGSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="AMReX__MCCGSolver_8H_source.html">AMReX_MCCGSolver.H</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab55bf033f00e65a388658d9956f666c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ab55bf033f00e65a388658d9956f666c4">MCCGSolver</a> (<a class="el" href="classamrex_1_1MCLinOp.html">MCLinOp</a> &amp;_lp, bool _use_mg_precond=false, int _lev=0)</td></tr>
<tr class="memdesc:ab55bf033f00e65a388658d9956f666c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ab55bf033f00e65a388658d9956f666c4">More...</a><br /></td></tr>
<tr class="separator:ab55bf033f00e65a388658d9956f666c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c096b58139bcee0a597db9fe71d8655"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a4c096b58139bcee0a597db9fe71d8655">~MCCGSolver</a> ()</td></tr>
<tr class="memdesc:a4c096b58139bcee0a597db9fe71d8655"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a4c096b58139bcee0a597db9fe71d8655">More...</a><br /></td></tr>
<tr class="separator:a4c096b58139bcee0a597db9fe71d8655"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6373248b084bc0f3bda2389408f32a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ace6373248b084bc0f3bda2389408f32a">solve</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;solnL, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;rhsL, Real eps_rel=-1.0, Real eps_abs=-1.0, <a class="el" href="namespaceamrex.html#ac6a345f3c5f30b5d97087d43bbf1c7ae">MCBC_Mode</a> bc_mode=<a class="el" href="namespaceamrex.html#ac6a345f3c5f30b5d97087d43bbf1c7aea372bb314280acee54f7e683ec43bbc19">MCInhomogeneous_BC</a>)</td></tr>
<tr class="memdesc:ace6373248b084bc0f3bda2389408f32a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the system, Lp(solnL)=rhsL to relative err, tolerance.  <a href="#ace6373248b084bc0f3bda2389408f32a">More...</a><br /></td></tr>
<tr class="separator:ace6373248b084bc0f3bda2389408f32a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c96febb684f0912a5d3113be02af4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#aa9c96febb684f0912a5d3113be02af4a">setMaxIter</a> (int _maxiter)</td></tr>
<tr class="memdesc:aa9c96febb684f0912a5d3113be02af4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum allowed number of CG iterations.  <a href="#aa9c96febb684f0912a5d3113be02af4a">More...</a><br /></td></tr>
<tr class="separator:aa9c96febb684f0912a5d3113be02af4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141954027a0fa1ea7aa08d8a6521ee27"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a141954027a0fa1ea7aa08d8a6521ee27">getMaxIter</a> () const </td></tr>
<tr class="memdesc:a141954027a0fa1ea7aa08d8a6521ee27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get maximum allowed number of CG iterations.  <a href="#a141954027a0fa1ea7aa08d8a6521ee27">More...</a><br /></td></tr>
<tr class="separator:a141954027a0fa1ea7aa08d8a6521ee27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ef4d42eb110b4f318134b9a3b2292d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a9ef4d42eb110b4f318134b9a3b2292d1">setExpert</a> (bool flag)</td></tr>
<tr class="memdesc:a9ef4d42eb110b4f318134b9a3b2292d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set expert mode.  <a href="#a9ef4d42eb110b4f318134b9a3b2292d1">More...</a><br /></td></tr>
<tr class="separator:a9ef4d42eb110b4f318134b9a3b2292d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a467ee14e8fe781bda0fd8c94d2d04bc1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a467ee14e8fe781bda0fd8c94d2d04bc1">getExpert</a> ()</td></tr>
<tr class="memdesc:a467ee14e8fe781bda0fd8c94d2d04bc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get expert flag.  <a href="#a467ee14e8fe781bda0fd8c94d2d04bc1">More...</a><br /></td></tr>
<tr class="separator:a467ee14e8fe781bda0fd8c94d2d04bc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac422ea3828ab3118a881044e3b3fdb1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ac422ea3828ab3118a881044e3b3fdb1c">setUseMGPrecond</a> (bool _use_mg_precond)</td></tr>
<tr class="memdesc:ac422ea3828ab3118a881044e3b3fdb1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set flag determining whether MG preconditioning is used.  <a href="#ac422ea3828ab3118a881044e3b3fdb1c">More...</a><br /></td></tr>
<tr class="separator:ac422ea3828ab3118a881044e3b3fdb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32f68d215f26b64f1d0bc6cc7dc75467"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a32f68d215f26b64f1d0bc6cc7dc75467">getUseMGPrecond</a> () const </td></tr>
<tr class="memdesc:a32f68d215f26b64f1d0bc6cc7dc75467"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flag determining whether MG preconditioning is used.  <a href="#a32f68d215f26b64f1d0bc6cc7dc75467">More...</a><br /></td></tr>
<tr class="separator:a32f68d215f26b64f1d0bc6cc7dc75467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb03ea644c46bb909ffd2443dfab9f75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#aeb03ea644c46bb909ffd2443dfab9f75">setVerbose</a> (int _verbose)</td></tr>
<tr class="memdesc:aeb03ea644c46bb909ffd2443dfab9f75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the verbosity value.  <a href="#aeb03ea644c46bb909ffd2443dfab9f75">More...</a><br /></td></tr>
<tr class="separator:aeb03ea644c46bb909ffd2443dfab9f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a916db148e30b0cf6af44003a7c918721"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a916db148e30b0cf6af44003a7c918721">getVerbose</a> ()</td></tr>
<tr class="memdesc:a916db148e30b0cf6af44003a7c918721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the verbosity value.  <a href="#a916db148e30b0cf6af44003a7c918721">More...</a><br /></td></tr>
<tr class="separator:a916db148e30b0cf6af44003a7c918721"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a29525b43a69948599ddf8f28ee19ed16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a29525b43a69948599ddf8f28ee19ed16">set_mg_precond</a> ()</td></tr>
<tr class="memdesc:a29525b43a69948599ddf8f28ee19ed16"><td class="mdescLeft">&#160;</td><td class="mdescRight">if (use_mg_precond == 1) then define the <a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> * mg_precond  <a href="#a29525b43a69948599ddf8f28ee19ed16">More...</a><br /></td></tr>
<tr class="separator:a29525b43a69948599ddf8f28ee19ed16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a14c82bd18f0e27f95922a978baa11c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a1a14c82bd18f0e27f95922a978baa11c">advance</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;p, Real beta, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;z)</td></tr>
<tr class="memdesc:a1a14c82bd18f0e27f95922a978baa11c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute <code>p = z + beta p</code> in the CG algorithm.  <a href="#a1a14c82bd18f0e27f95922a978baa11c">More...</a><br /></td></tr>
<tr class="separator:a1a14c82bd18f0e27f95922a978baa11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50e37542d2b4e0541dadba8c6d70718"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ae50e37542d2b4e0541dadba8c6d70718">update</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;sol, Real alpha, <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;r, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;p, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;w)</td></tr>
<tr class="memdesc:ae50e37542d2b4e0541dadba8c6d70718"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute <code>x =+ alpha p</code> and <code>r -= alpha w</code> in the CG algorithm.  <a href="#ae50e37542d2b4e0541dadba8c6d70718">More...</a><br /></td></tr>
<tr class="separator:ae50e37542d2b4e0541dadba8c6d70718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc070d27df8fb7a2fae8791f02138d2"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a7cc070d27df8fb7a2fae8791f02138d2">axp</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;w, <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;p, <a class="el" href="namespaceamrex.html#ac6a345f3c5f30b5d97087d43bbf1c7ae">MCBC_Mode</a> bc_mode)</td></tr>
<tr class="memdesc:a7cc070d27df8fb7a2fae8791f02138d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute <code>w = A.p</code>, and return <code>Transpose(p).w</code> in the CG algorithm.  <a href="#a7cc070d27df8fb7a2fae8791f02138d2">More...</a><br /></td></tr>
<tr class="separator:a7cc070d27df8fb7a2fae8791f02138d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba7af676d39a70ba4eeedaf9a4d8b76c"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#aba7af676d39a70ba4eeedaf9a4d8b76c">norm</a> (const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;res)</td></tr>
<tr class="memdesc:aba7af676d39a70ba4eeedaf9a4d8b76c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute a suitable norm of the residual, used to check stopping criteria.  <a href="#aba7af676d39a70ba4eeedaf9a4d8b76c">More...</a><br /></td></tr>
<tr class="separator:aba7af676d39a70ba4eeedaf9a4d8b76c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a5bfc289cf8e870cc5b1f3c8bcbef259c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a5bfc289cf8e870cc5b1f3c8bcbef259c">Initialize</a> ()</td></tr>
<tr class="memdesc:a5bfc289cf8e870cc5b1f3c8bcbef259c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct work space, initialize parameters.  <a href="#a5bfc289cf8e870cc5b1f3c8bcbef259c">More...</a><br /></td></tr>
<tr class="separator:a5bfc289cf8e870cc5b1f3c8bcbef259c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af51e8dc97acea4a946ae8eab56ff01d2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#af51e8dc97acea4a946ae8eab56ff01d2">Finalize</a> ()</td></tr>
<tr class="separator:af51e8dc97acea4a946ae8eab56ff01d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aeee5195f76b84b035425eedc100bcf19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#aeee5195f76b84b035425eedc100bcf19">mg_precond</a></td></tr>
<tr class="memdesc:aeee5195f76b84b035425eedc100bcf19"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> solver to be used as preconditioner.  <a href="#aeee5195f76b84b035425eedc100bcf19">More...</a><br /></td></tr>
<tr class="separator:aeee5195f76b84b035425eedc100bcf19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b81280f291f125be775cfbcc43149b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ad9b81280f291f125be775cfbcc43149b">use_mg_precond</a></td></tr>
<tr class="memdesc:ad9b81280f291f125be775cfbcc43149b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag: use multigrid as a preconditioner.  <a href="#ad9b81280f291f125be775cfbcc43149b">More...</a><br /></td></tr>
<tr class="separator:ad9b81280f291f125be775cfbcc43149b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67daa471cadd81cbb09965c635596445"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a67daa471cadd81cbb09965c635596445">isExpert</a></td></tr>
<tr class="separator:a67daa471cadd81cbb09965c635596445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a775fea91c8de5771a4d217d7ea20e213"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a775fea91c8de5771a4d217d7ea20e213">maxiter</a></td></tr>
<tr class="memdesc:a775fea91c8de5771a4d217d7ea20e213"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current maximum number of allowed iterations, verbosity.  <a href="#a775fea91c8de5771a4d217d7ea20e213">More...</a><br /></td></tr>
<tr class="separator:a775fea91c8de5771a4d217d7ea20e213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a06491cdcef828b05e36f74ad9724f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a1a06491cdcef828b05e36f74ad9724f7">verbose</a></td></tr>
<tr class="separator:a1a06491cdcef828b05e36f74ad9724f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166d6c36b89a891affdcf6119ccd84be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1MCLinOp.html">MCLinOp</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a166d6c36b89a891affdcf6119ccd84be">Lp</a></td></tr>
<tr class="memdesc:a166d6c36b89a891affdcf6119ccd84be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to operator for linear system to be solved.  <a href="#a166d6c36b89a891affdcf6119ccd84be">More...</a><br /></td></tr>
<tr class="separator:a166d6c36b89a891affdcf6119ccd84be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed9b8949788d702a4f659f9edb7215a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#aed9b8949788d702a4f659f9edb7215a4">lev</a></td></tr>
<tr class="memdesc:aed9b8949788d702a4f659f9edb7215a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer to choose which "level" of the linear operator to use.  <a href="#aed9b8949788d702a4f659f9edb7215a4">More...</a><br /></td></tr>
<tr class="separator:aed9b8949788d702a4f659f9edb7215a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:ae05da5eb36acf3226889ff349b982cc5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ae05da5eb36acf3226889ff349b982cc5">def_maxiter</a></td></tr>
<tr class="memdesc:ae05da5eb36acf3226889ff349b982cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default maximum number of allowed iterations, verbosity.  <a href="#ae05da5eb36acf3226889ff349b982cc5">More...</a><br /></td></tr>
<tr class="separator:ae05da5eb36acf3226889ff349b982cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00208f13edc6adf1d115624d2f0e5896"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#a00208f13edc6adf1d115624d2f0e5896">def_verbose</a></td></tr>
<tr class="separator:a00208f13edc6adf1d115624d2f0e5896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7c9edae0568cb7221b4f2a7a6c8bf89"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ab7c9edae0568cb7221b4f2a7a6c8bf89">def_unstable_criterion</a></td></tr>
<tr class="memdesc:ab7c9edae0568cb7221b4f2a7a6c8bf89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default unstable_criterion used to test for loss of accuracy in.  <a href="#ab7c9edae0568cb7221b4f2a7a6c8bf89">More...</a><br /></td></tr>
<tr class="separator:ab7c9edae0568cb7221b4f2a7a6c8bf89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbb2d6c25ce5d9a779e799534b5b90a3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#adbb2d6c25ce5d9a779e799534b5b90a3">def_isExpert</a></td></tr>
<tr class="memdesc:adbb2d6c25ce5d9a779e799534b5b90a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag determining action when error conditions are hit.  <a href="#adbb2d6c25ce5d9a779e799534b5b90a3">More...</a><br /></td></tr>
<tr class="separator:adbb2d6c25ce5d9a779e799534b5b90a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:af7ee3ecbb71ab8437ffddd5e8ca3870d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#af7ee3ecbb71ab8437ffddd5e8ca3870d">MCCGSolver</a> (const <a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> &amp;)</td></tr>
<tr class="memdesc:af7ee3ecbb71ab8437ffddd5e8ca3870d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable copy constructor, = operator.  <a href="#af7ee3ecbb71ab8437ffddd5e8ca3870d">More...</a><br /></td></tr>
<tr class="separator:af7ee3ecbb71ab8437ffddd5e8ca3870d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac385e84dfcde72774ade2a0ad744c0b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1MCCGSolver.html#ac385e84dfcde72774ade2a0ad744c0b3">operator=</a> (const <a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> &amp;)</td></tr>
<tr class="separator:ac385e84dfcde72774ade2a0ad744c0b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A CGColver solves the linear equation, L(phi)=rhs, for a <a class="el" href="classamrex_1_1MCLinOp.html" title="A MCLinOp is a virtual base class for general linear operators capable of acting on multicomponent Mu...">MCLinOp</a> L and MultiFabs rhs and phi, using the conjugate gradient algorithm, either vanilla, or preconditioned via a single V-cycle of multigrid.</p>
<p>A <a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> object solves the linear equation, L(phi)=rhs for a <a class="el" href="classamrex_1_1MCLinOp.html" title="A MCLinOp is a virtual base class for general linear operators capable of acting on multicomponent Mu...">MCLinOp</a> L, and MultiFabs phi and rhs. A <a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> is constructed with a fully initialized 2D or 3D <a class="el" href="classamrex_1_1MCLinOp.html" title="A MCLinOp is a virtual base class for general linear operators capable of acting on multicomponent Mu...">MCLinOp</a>, and responds to "solve" requests of various signatures. The solve request (implicitly) includes a flag as to whether the system is to be solved with homogeneous boundary conditions or no. If homogeneous BCs are requested, all boundary information within the <a class="el" href="classamrex_1_1MCLinOp.html" title="A MCLinOp is a virtual base class for general linear operators capable of acting on multicomponent Mu...">MCLinOp</a> is used, except that the values of boundary FabSets are zeroed. The algorithm follows closely that described of p15 of the SIAM book, "Templates for the Solution of
Linear Systems". Before solving a system, a small number of control parameters may be modified (maximum number of allowed iterations, reporting verbosity, etc). Also, either on construction or via member access functions, the user may choose to use a V-cycle 1-step <a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> preconditioner within the CG loop by setting the appropriate bool flag (see members/ctrs below). The MG preconditioner used is just an instantiation of a <a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> class object (the <a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> class is documented separately).</p>
<p>Implementation Notes:</p>
<p>This algorithm implements solution of equations in a way that requires linearity of the operator. In "residual correction form", equations are solved only for the "correction" to the initial guess that is required to solve the desired system. In particular, boundary conditions are assumed to be satisfied after a single application of the linear operator (therefore, the correction is homogeneous at the boundary). As a result, after putting the problem in residual correction form, the entire system CG system has homigeneous boundary conditions. This solver therefore cannot incorporate fully nonlinear systems.</p>
<p>In general, a <a class="el" href="classamrex_1_1MCLinOp.html" title="A MCLinOp is a virtual base class for general linear operators capable of acting on multicomponent Mu...">MCLinOp</a> has the ability to apply high-order interpolation methods for computing boundary values. However, if the operator used in this <a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> is non-symmetric, cg performance suffers tremendously. As a result, BC's should be applied with interpolants of order less than or equal to 2. We do not enforce this condition rigourosly, since it would interfere with the user's definition of the operator. If cg performance is bad however, setting the <a class="el" href="classamrex_1_1MCLinOp.html" title="A MCLinOp is a virtual base class for general linear operators capable of acting on multicomponent Mu...">MCLinOp</a>'s maxorder=2 is a good place to start.</p>
<p>Default settings: The user has access to the following options in the cg algorithm:</p>
<p>maxiter(40) Maximum number of cg cycles allowed to solve the system before abandoning verbose(0) Verbosity (1-results, 2-progress, 3-detailed progress) use_mg_precond(false) Whether to use the V-cycle multigrid solver for the preconditioner system </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab55bf033f00e65a388658d9956f666c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MCCGSolver::MCCGSolver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MCLinOp.html">MCLinOp</a> &amp;&#160;</td>
          <td class="paramname"><em>_lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>_use_mg_precond</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_lev</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_lp</td><td></td></tr>
    <tr><td class="paramname">_use_mg_precond</td><td></td></tr>
    <tr><td class="paramname">_lev</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4c096b58139bcee0a597db9fe71d8655"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MCCGSolver::~MCCGSolver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

</div>
</div>
<a class="anchor" id="af7ee3ecbb71ab8437ffddd5e8ca3870d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::MCCGSolver::MCCGSolver </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disable copy constructor, = operator. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a1a14c82bd18f0e27f95922a978baa11c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::advance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute <code>p = z + beta p</code> in the CG algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td></td></tr>
    <tr><td class="paramname">beta</td><td></td></tr>
    <tr><td class="paramname">z</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7cc070d27df8fb7a2fae8791f02138d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real amrex::MCCGSolver::axp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceamrex.html#ac6a345f3c5f30b5d97087d43bbf1c7ae">MCBC_Mode</a>&#160;</td>
          <td class="paramname"><em>bc_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute <code>w = A.p</code>, and return <code>Transpose(p).w</code> in the CG algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td></td></tr>
    <tr><td class="paramname">p</td><td></td></tr>
    <tr><td class="paramname">bc_mode</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af51e8dc97acea4a946ae8eab56ff01d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::Finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a467ee14e8fe781bda0fd8c94d2d04bc1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::MCCGSolver::getExpert </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get expert flag. </p>

</div>
</div>
<a class="anchor" id="a141954027a0fa1ea7aa08d8a6521ee27"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::getMaxIter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get maximum allowed number of CG iterations. </p>

</div>
</div>
<a class="anchor" id="a32f68d215f26b64f1d0bc6cc7dc75467"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::MCCGSolver::getUseMGPrecond </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get flag determining whether MG preconditioning is used. </p>

</div>
</div>
<a class="anchor" id="a916db148e30b0cf6af44003a7c918721"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::getVerbose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the verbosity value. </p>

</div>
</div>
<a class="anchor" id="a5bfc289cf8e870cc5b1f3c8bcbef259c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::Initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct work space, initialize parameters. </p>

</div>
</div>
<a class="anchor" id="aba7af676d39a70ba4eeedaf9a4d8b76c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real amrex::MCCGSolver::norm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>res</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute a suitable norm of the residual, used to check stopping criteria. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">res</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac385e84dfcde72774ade2a0ad744c0b3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a>&amp; amrex::MCCGSolver::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MCCGSolver.html">MCCGSolver</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a29525b43a69948599ddf8f28ee19ed16"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::set_mg_precond </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>if (use_mg_precond == 1) then define the <a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> * mg_precond </p>

</div>
</div>
<a class="anchor" id="a9ef4d42eb110b4f318134b9a3b2292d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::setExpert </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set expert mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa9c96febb684f0912a5d3113be02af4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::setMaxIter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_maxiter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set maximum allowed number of CG iterations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_maxiter</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac422ea3828ab3118a881044e3b3fdb1c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::setUseMGPrecond </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>_use_mg_precond</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set flag determining whether MG preconditioning is used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_use_mg_precond</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aeb03ea644c46bb909ffd2443dfab9f75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::setVerbose </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the verbosity value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_verbose</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ace6373248b084bc0f3bda2389408f32a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>solnL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhsL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_rel</em> = <code>-1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_abs</em> = <code>-1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceamrex.html#ac6a345f3c5f30b5d97087d43bbf1c7ae">MCBC_Mode</a>&#160;</td>
          <td class="paramname"><em>bc_mode</em> = <code><a class="el" href="namespaceamrex.html#ac6a345f3c5f30b5d97087d43bbf1c7aea372bb314280acee54f7e683ec43bbc19">MCInhomogeneous_BC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve the system, Lp(solnL)=rhsL to relative err, tolerance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">solnL</td><td></td></tr>
    <tr><td class="paramname">rhsL</td><td></td></tr>
    <tr><td class="paramname">eps_rel</td><td></td></tr>
    <tr><td class="paramname">eps_abs</td><td></td></tr>
    <tr><td class="paramname">bc_mode</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae50e37542d2b4e0541dadba8c6d70718"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::MCCGSolver::update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute <code>x =+ alpha p</code> and <code>r -= alpha w</code> in the CG algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sol</td><td></td></tr>
    <tr><td class="paramname">alpha</td><td></td></tr>
    <tr><td class="paramname">r</td><td></td></tr>
    <tr><td class="paramname">p</td><td></td></tr>
    <tr><td class="paramname">w</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="adbb2d6c25ce5d9a779e799534b5b90a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::def_isExpert</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag determining action when error conditions are hit. </p>

</div>
</div>
<a class="anchor" id="ae05da5eb36acf3226889ff349b982cc5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::def_maxiter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default maximum number of allowed iterations, verbosity. </p>

</div>
</div>
<a class="anchor" id="ab7c9edae0568cb7221b4f2a7a6c8bf89"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double amrex::MCCGSolver::def_unstable_criterion</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default unstable_criterion used to test for loss of accuracy in. </p>

</div>
</div>
<a class="anchor" id="a00208f13edc6adf1d115624d2f0e5896"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::def_verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a67daa471cadd81cbb09965c635596445"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::MCCGSolver::isExpert</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aed9b8949788d702a4f659f9edb7215a4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integer to choose which "level" of the linear operator to use. </p>

</div>
</div>
<a class="anchor" id="a166d6c36b89a891affdcf6119ccd84be"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1MCLinOp.html">MCLinOp</a>&amp; amrex::MCCGSolver::Lp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reference to operator for linear system to be solved. </p>

</div>
</div>
<a class="anchor" id="a775fea91c8de5771a4d217d7ea20e213"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::maxiter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current maximum number of allowed iterations, verbosity. </p>

</div>
</div>
<a class="anchor" id="aeee5195f76b84b035425eedc100bcf19"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a>* amrex::MCCGSolver::mg_precond</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classamrex_1_1MCMultiGrid.html">MCMultiGrid</a> solver to be used as preconditioner. </p>

</div>
</div>
<a class="anchor" id="ad9b81280f291f125be775cfbcc43149b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::MCCGSolver::use_mg_precond</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag: use multigrid as a preconditioner. </p>

</div>
</div>
<a class="anchor" id="a1a06491cdcef828b05e36f74ad9724f7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::MCCGSolver::verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/AMReX-Codes/amrex/Src/LinearSolvers/C_TensorMG/<a class="el" href="AMReX__MCCGSolver_8H_source.html">AMReX_MCCGSolver.H</a></li>
<li>/home/travis/build/AMReX-Codes/amrex/Src/LinearSolvers/C_TensorMG/<a class="el" href="AMReX__MCCGSolver_8cpp.html">AMReX_MCCGSolver.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
