<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!--title>AMReX: amrex::FillPatcher&lt; MF &gt; Class Template Reference</title-->
<title>AMReX: Block-Structured AMR Software Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="amrex_logo_tiny.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Block-Structured AMR Software Framework
   </div>
   <!--div id="projectbrief">Block-Structured AMR Software Framework</div-->
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classamrex_1_1FillPatcher.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classamrex_1_1FillPatcher-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">amrex::FillPatcher&lt; MF &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a> is for filling a fine level MultiFab/FabArray.  
 <a href="classamrex_1_1FillPatcher.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="AMReX__FillPatcher_8H_source.html">AMReX_FillPatcher.H</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ada287d163c195f7f8c254479ebe18d51" id="r_ada287d163c195f7f8c254479ebe18d51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1FillPatcher.html#ada287d163c195f7f8c254479ebe18d51">FillPatcher</a> (<a class="el" href="classamrex_1_1BoxArray.html">BoxArray</a> const &amp;fba, <a class="el" href="classamrex_1_1DistributionMapping.html">DistributionMapping</a> const &amp;fdm, <a class="el" href="classamrex_1_1Geometry.html">Geometry</a> const &amp;fgeom, <a class="el" href="classamrex_1_1BoxArray.html">BoxArray</a> const &amp;cba, <a class="el" href="classamrex_1_1DistributionMapping.html">DistributionMapping</a> const &amp;cdm, <a class="el" href="classamrex_1_1Geometry.html">Geometry</a> const &amp;cgeom, <a class="el" href="namespaceamrex.html#a95101764f5ec64cd1dd6e55614702cdb">IntVect</a> const &amp;nghost, int ncomp, <a class="el" href="classamrex_1_1InterpBase.html">InterpBase</a> *interp, <a class="el" href="classamrex_1_1EB2_1_1IndexSpace.html">EB2::IndexSpace</a> const *eb_index_space=<a class="el" href="namespaceamrex_1_1EB2.html#ab08bb163ec9d566ce748dd6c4a7f0385">EB2::TopIndexSpaceIfPresent</a>())</td></tr>
<tr class="memdesc:ada287d163c195f7f8c254479ebe18d51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor of <a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a>.  <br /></td></tr>
<tr class="separator:ada287d163c195f7f8c254479ebe18d51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e5303eea72dd1c6c8469f75ea51247" id="r_a93e5303eea72dd1c6c8469f75ea51247"><td class="memTemplParams" colspan="2">template&lt;typename BC , typename PreInterpHook  = NullInterpHook&lt;MF&gt;, typename PostInterpHook  = NullInterpHook&lt;MF&gt;&gt; </td></tr>
<tr class="memitem:a93e5303eea72dd1c6c8469f75ea51247"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classamrex_1_1FillPatcher.html#a93e5303eea72dd1c6c8469f75ea51247">fill</a> (MF &amp;mf, <a class="el" href="namespaceamrex.html#a95101764f5ec64cd1dd6e55614702cdb">IntVect</a> const &amp;nghost, <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> time, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; MF * &gt; const &amp;cmf, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> &gt; const &amp;ct, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; MF * &gt; const &amp;fmf, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> &gt; const &amp;ft, int scomp, int dcomp, int ncomp, BC &amp;cbc, int cbccomp, BC &amp;fbc, int fbccomp, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="classamrex_1_1BCRec.html">BCRec</a> &gt; const &amp;bcs, int bcscomp, PreInterpHook const &amp;pre_interp={}, PostInterpHook const &amp;post_interp={})</td></tr>
<tr class="memdesc:a93e5303eea72dd1c6c8469f75ea51247"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to fill data.  <br /></td></tr>
<tr class="separator:a93e5303eea72dd1c6c8469f75ea51247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93d1f3a709bbf485e19c948875fc6c0c" id="r_a93d1f3a709bbf485e19c948875fc6c0c"><td class="memTemplParams" colspan="2">template&lt;typename BC , typename PreInterpHook  = NullInterpHook&lt;MF&gt;, typename PostInterpHook  = NullInterpHook&lt;MF&gt;&gt; </td></tr>
<tr class="memitem:a93d1f3a709bbf485e19c948875fc6c0c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classamrex_1_1FillPatcher.html#a93d1f3a709bbf485e19c948875fc6c0c">fillCoarseFineBoundary</a> (MF &amp;mf, <a class="el" href="namespaceamrex.html#a95101764f5ec64cd1dd6e55614702cdb">IntVect</a> const &amp;nghost, <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> time, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; MF * &gt; const &amp;cmf, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> &gt; const &amp;ct, int scomp, int dcomp, int ncomp, BC &amp;cbc, int cbccomp, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="classamrex_1_1BCRec.html">BCRec</a> &gt; const &amp;bcs, int bcscomp, PreInterpHook const &amp;pre_interp={}, PostInterpHook const &amp;post_interp={})</td></tr>
<tr class="memdesc:a93d1f3a709bbf485e19c948875fc6c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to fill data at coarse/fine boundary only.  <br /></td></tr>
<tr class="separator:a93d1f3a709bbf485e19c948875fc6c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad059e9960589afeff57d54307acd2dca" id="r_ad059e9960589afeff57d54307acd2dca"><td class="memTemplParams" colspan="2">template&lt;std::size_t order&gt; </td></tr>
<tr class="memitem:ad059e9960589afeff57d54307acd2dca"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classamrex_1_1FillPatcher.html#ad059e9960589afeff57d54307acd2dca">storeRKCoarseData</a> (<a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> time, <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> dt, MF const &amp;S_old, <a class="el" href="group__amrex__linear__containers.html#gafe930d74045516fece8591f173e57007">Array</a>&lt; MF, order &gt; const &amp;RK_k)</td></tr>
<tr class="memdesc:ad059e9960589afeff57d54307acd2dca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store coarse AMR level data for RK3 and RK4.  <br /></td></tr>
<tr class="separator:ad059e9960589afeff57d54307acd2dca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa756e7fa531116007159b132f0312577" id="r_aa756e7fa531116007159b132f0312577"><td class="memTemplParams" colspan="2">template&lt;typename BC &gt; </td></tr>
<tr class="memitem:aa756e7fa531116007159b132f0312577"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classamrex_1_1FillPatcher.html#aa756e7fa531116007159b132f0312577">fillRK</a> (int stage, int iteration, int ncycle, MF &amp;mf, <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> time, BC &amp;cbc, BC &amp;fbc, <a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="classamrex_1_1BCRec.html">BCRec</a> &gt; const &amp;bcs)</td></tr>
<tr class="memdesc:aa756e7fa531116007159b132f0312577"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill ghost cells of fine AMR level for RK3 and RK4.  <br /></td></tr>
<tr class="separator:aa756e7fa531116007159b132f0312577"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;class MF = MultiFab&gt;<br />
class amrex::FillPatcher&lt; MF &gt;</div><p><a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a> is for filling a fine level MultiFab/FabArray. </p>
<p>This class is not as general as the FillPatchTwoLevels functions. It fills the fine ghost cells not overlapping any fine level valid cells with interpolation of the coarse data. Then it fills the fine ghost cells overlapping fine level valid cells with the fine level data. If the valid cells of the destination need to be filled, it will be done as well. Finally, it will fill the physical boundary using the user provided functor. The <code>fill</code> member function can be used to do the operations just described. Alternatively, one can also use the <code>fillCoarseFineBounary</code> to fill the ghost cells at the coarse/fine boundary only. Then one can manually call FillBoundary to fill the other ghost cells, and use the physical BC functor to handle the physical boundary.</p>
<p>The communication of the coarse data needed for spatial interpolation is optimized at the cost of being error-prone. One must follow the following guidelines.</p>
<p>(1) This class is for filling data during time stepping, not during regrid. The fine level data passed as input must have the same <a class="el" href="classamrex_1_1BoxArray.html" title="A collection of Boxes stored in an Array.">BoxArray</a> and <a class="el" href="classamrex_1_1DistributionMapping.html" title="Calculates the distribution of FABs to MPI processes.">DistributionMapping</a> as the destination. It's OK they are the same <a class="el" href="classamrex_1_1MultiFab.html" title="A collection (stored as an array) of FArrayBox objects.">MultiFab</a>. For <a class="el" href="classamrex_1_1AmrLevel.html" title="Virtual base class for managing individual levels. AmrLevel functions both as a container for state d...">AmrLevel</a> based codes, <a class="el" href="classamrex_1_1AmrLevel.html#af7dbabf3cd9767f5e38dc96157986618" title="Fill with FillPatcher on level &gt; 0 and AmrLevel::FillPatch on level 0.">AmrLevel::FillPatcherFill</a> will try to use <a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a> if it can, and <a class="el" href="classamrex_1_1AmrLevel.html#a55c1a2d0040ba28bf022fb293113a5f2">AmrLevel::FillPatch</a> will use the fillpatch functions.</p>
<p>(2) When to build? It is recommended that one uses <code>std::unique_ptr</code> to store the <a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a> object, and build it only when it is needed and it's a nullptr. For <a class="el" href="classamrex_1_1AmrLevel.html" title="Virtual base class for managing individual levels. AmrLevel functions both as a container for state d...">AmrLevel</a> based codes, the <a class="el" href="classamrex_1_1AmrLevel.html" title="Virtual base class for managing individual levels. AmrLevel functions both as a container for state d...">AmrLevel</a> class will build it for you as needed when you call the <a class="el" href="classamrex_1_1AmrLevel.html#af7dbabf3cd9767f5e38dc96157986618" title="Fill with FillPatcher on level &gt; 0 and AmrLevel::FillPatch on level 0.">AmrLevel::FillPatcherFill</a> function.</p>
<p>(3) When to destroy? Usually, we do time steppig on a coarse level first. Then we recursively do time stepping on fine levels. After the finer level finishes, we do reflux and average the fine data down to the coarse level. After that we should destroy the <a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a> object associated with these two levels, because the coarse data stored in the object has become outdated. For <a class="el" href="classamrex_1_1AmrCore.html" title="Provide basic functionalities to set up an AMR hierarchy.">AmrCore</a> based codes, you could use Tests/Amr/Advection_AmrCore as an example. For <a class="el" href="classamrex_1_1AmrLevel.html" title="Virtual base class for managing individual levels. AmrLevel functions both as a container for state d...">AmrLevel</a> based codes, you should do this in the post_timestep virtual function (see Tests/Amr/Advection_AmrLevel for an example).</p>
<p>(4) The source MultiFabs/FabArrays (i.e., the crse_data and fine_data arguments of the fill function) need to have exactly the same number of components as the ncomp argument of the constructor, even though it's allowed to fill only some of the components with the fill function.</p>
<p>(5) This only works for cell-centered and nodal data.</p>
<p>This class also provides support for <a class="el" href="namespaceamrex_1_1RungeKutta.html#ae717fc5f1594b2062a5178d495ae0edd" title="Time stepping with RK3.">RungeKutta::RK3</a> and <a class="el" href="namespaceamrex_1_1RungeKutta.html#adafe95f71429898362d5c7d0f9e0ccd7" title="Time stepping with RK4.">RungeKutta::RK4</a>. The storeRKCoarseData function can be used to store coarse AMR level data that are needed for filling fine level data's ghost cells in this class. The <code>fillRK</code> function can be used to fill ghost cells for fine AMR levels. This operation at the coarse/fine boundary is non-trivial for RK orders higher than 2. Note that it is expected that time stepping on the coarse level is perform before any fine level time stepping, and it's the user's responsibility to properly create and destroy this object. See <a class="el" href="classamrex_1_1AmrLevel.html#a95aea02fe7abbf3d1e5cd58ee5ff7d41" title="Evolve one step with Runge-Kutta (2, 3, or 4)">AmrLevel::RK</a> for an example of using the <a class="el" href="namespaceamrex_1_1RungeKutta.html" title="Functions for Runge-Kutta methods.">RungeKutta</a> functions and <a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a> together. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ada287d163c195f7f8c254479ebe18d51" name="ada287d163c195f7f8c254479ebe18d51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada287d163c195f7f8c254479ebe18d51">&#9670;&#160;</a></span>FillPatcher()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class MF &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1FillPatcher.html">amrex::FillPatcher</a>&lt; MF &gt;::FillPatcher </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1BoxArray.html">BoxArray</a> const &amp;&#160;</td>
          <td class="paramname"><em>fba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1DistributionMapping.html">DistributionMapping</a> const &amp;&#160;</td>
          <td class="paramname"><em>fdm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Geometry.html">Geometry</a> const &amp;&#160;</td>
          <td class="paramname"><em>fgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1BoxArray.html">BoxArray</a> const &amp;&#160;</td>
          <td class="paramname"><em>cba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1DistributionMapping.html">DistributionMapping</a> const &amp;&#160;</td>
          <td class="paramname"><em>cdm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Geometry.html">Geometry</a> const &amp;&#160;</td>
          <td class="paramname"><em>cgeom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceamrex.html#a95101764f5ec64cd1dd6e55614702cdb">IntVect</a> const &amp;&#160;</td>
          <td class="paramname"><em>nghost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1InterpBase.html">InterpBase</a> *&#160;</td>
          <td class="paramname"><em>interp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1EB2_1_1IndexSpace.html">EB2::IndexSpace</a> const *&#160;</td>
          <td class="paramname"><em>eb_index_space</em> = <code><a class="el" href="namespaceamrex_1_1EB2.html#ab08bb163ec9d566ce748dd6c4a7f0385">EB2::TopIndexSpaceIfPresent</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor of <a class="el" href="classamrex_1_1FillPatcher.html" title="FillPatcher is for filling a fine level MultiFab/FabArray.">FillPatcher</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fba</td><td>fine level <a class="el" href="classamrex_1_1BoxArray.html" title="A collection of Boxes stored in an Array.">BoxArray</a> </td></tr>
    <tr><td class="paramname">fdm</td><td>fine level <a class="el" href="classamrex_1_1DistributionMapping.html" title="Calculates the distribution of FABs to MPI processes.">DistributionMapping</a> </td></tr>
    <tr><td class="paramname">fgeom</td><td>fine level <a class="el" href="classamrex_1_1Geometry.html" title="Rectangular problem domain geometry.">Geometry</a> </td></tr>
    <tr><td class="paramname">cba</td><td>coarse level <a class="el" href="classamrex_1_1BoxArray.html" title="A collection of Boxes stored in an Array.">BoxArray</a> </td></tr>
    <tr><td class="paramname">cdm</td><td>coarse level <a class="el" href="classamrex_1_1DistributionMapping.html" title="Calculates the distribution of FABs to MPI processes.">DistributionMapping</a> </td></tr>
    <tr><td class="paramname">cgeom</td><td>coarse level <a class="el" href="classamrex_1_1Geometry.html" title="Rectangular problem domain geometry.">Geometry</a> </td></tr>
    <tr><td class="paramname">nghost</td><td>max number of ghost cells to be filled at coarse/fine boundary </td></tr>
    <tr><td class="paramname">ncomp</td><td>the number of components </td></tr>
    <tr><td class="paramname">interp</td><td>for spatial interpolation </td></tr>
    <tr><td class="paramname">eb_index_space</td><td>optional argument for specifying EB IndexSpace </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a93e5303eea72dd1c6c8469f75ea51247" name="a93e5303eea72dd1c6c8469f75ea51247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93e5303eea72dd1c6c8469f75ea51247">&#9670;&#160;</a></span>fill()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class MF &gt; </div>
<div class="memtemplate">
template&lt;typename BC , typename PreInterpHook , typename PostInterpHook &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classamrex_1_1FillPatcher.html">amrex::FillPatcher</a>&lt; MF &gt;::fill </td>
          <td>(</td>
          <td class="paramtype">MF &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceamrex.html#a95101764f5ec64cd1dd6e55614702cdb">IntVect</a> const &amp;&#160;</td>
          <td class="paramname"><em>nghost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a>&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; MF * &gt; const &amp;&#160;</td>
          <td class="paramname"><em>cmf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; MF * &gt; const &amp;&#160;</td>
          <td class="paramname"><em>fmf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>ft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dcomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BC &amp;&#160;</td>
          <td class="paramname"><em>cbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cbccomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BC &amp;&#160;</td>
          <td class="paramname"><em>fbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fbccomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="classamrex_1_1BCRec.html">BCRec</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>bcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bcscomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PreInterpHook const &amp;&#160;</td>
          <td class="paramname"><em>pre_interp</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PostInterpHook const &amp;&#160;</td>
          <td class="paramname"><em>post_interp</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to fill data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mf</td><td>destination MultiFab/FabArray </td></tr>
    <tr><td class="paramname">nghost</td><td>number of ghost cells to fill. This must be &lt;= what's provided to the constructor </td></tr>
    <tr><td class="paramname">time</td><td>time associated with the destination </td></tr>
    <tr><td class="paramname">cmf</td><td>coarse level data </td></tr>
    <tr><td class="paramname">ct</td><td>time associated with the coarse data </td></tr>
    <tr><td class="paramname">fmf</td><td>fine level data </td></tr>
    <tr><td class="paramname">ft</td><td>time associated with the fine data </td></tr>
    <tr><td class="paramname">scomp</td><td>starting component of the source </td></tr>
    <tr><td class="paramname">dcomp</td><td>starting component of the destination </td></tr>
    <tr><td class="paramname">ncomp</td><td>the number of components to fill </td></tr>
    <tr><td class="paramname">cbc</td><td>for filling coarse level physical BC </td></tr>
    <tr><td class="paramname">cbccomp</td><td>starting component of the coarse level BC functor </td></tr>
    <tr><td class="paramname">fbc</td><td>for filling fine level physical BC </td></tr>
    <tr><td class="paramname">fbccomp</td><td>starting component of the fine level BC functor </td></tr>
    <tr><td class="paramname">bcs</td><td><a class="el" href="classamrex_1_1BCRec.html" title="Boundary Condition Records. Necessary information and functions for computing boundary conditions.">BCRec</a> specifying physical boundary types </td></tr>
    <tr><td class="paramname">bcscomp</td><td>starting component of the <a class="el" href="classamrex_1_1BCRec.html" title="Boundary Condition Records. Necessary information and functions for computing boundary conditions.">BCRec</a> <a class="el" href="classamrex_1_1Vector.html" title="This class is a thin wrapper around std::vector. Unlike vector, Vector::operator[] provides bound che...">Vector</a>. </td></tr>
    <tr><td class="paramname">pre_interp</td><td>optional pre-interpolation hook for modifying the coarse data </td></tr>
    <tr><td class="paramname">post_interp</td><td>optional post-interpolation hook for modifying the fine data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a93d1f3a709bbf485e19c948875fc6c0c" name="a93d1f3a709bbf485e19c948875fc6c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93d1f3a709bbf485e19c948875fc6c0c">&#9670;&#160;</a></span>fillCoarseFineBoundary()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class MF &gt; </div>
<div class="memtemplate">
template&lt;typename BC , typename PreInterpHook , typename PostInterpHook &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classamrex_1_1FillPatcher.html">amrex::FillPatcher</a>&lt; MF &gt;::fillCoarseFineBoundary </td>
          <td>(</td>
          <td class="paramtype">MF &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceamrex.html#a95101764f5ec64cd1dd6e55614702cdb">IntVect</a> const &amp;&#160;</td>
          <td class="paramname"><em>nghost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a>&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; MF * &gt; const &amp;&#160;</td>
          <td class="paramname"><em>cmf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dcomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BC &amp;&#160;</td>
          <td class="paramname"><em>cbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cbccomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="classamrex_1_1BCRec.html">BCRec</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>bcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bcscomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PreInterpHook const &amp;&#160;</td>
          <td class="paramname"><em>pre_interp</em> = <code>{}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PostInterpHook const &amp;&#160;</td>
          <td class="paramname"><em>post_interp</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to fill data at coarse/fine boundary only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mf</td><td>destination MultiFab/FabArray </td></tr>
    <tr><td class="paramname">nghost</td><td>number of ghost cells to fill. This must be &lt;= what's provided to the constructor </td></tr>
    <tr><td class="paramname">time</td><td>time associated with the destination </td></tr>
    <tr><td class="paramname">cmf</td><td>coarse level data </td></tr>
    <tr><td class="paramname">ct</td><td>time associated with the coarse data </td></tr>
    <tr><td class="paramname">scomp</td><td>starting component of the source </td></tr>
    <tr><td class="paramname">dcomp</td><td>starting component of the destination </td></tr>
    <tr><td class="paramname">ncomp</td><td>the number of components to fill </td></tr>
    <tr><td class="paramname">cbc</td><td>for filling coarse level physical BC </td></tr>
    <tr><td class="paramname">cbccomp</td><td>starting component of the coarse level BC functor </td></tr>
    <tr><td class="paramname">bcs</td><td><a class="el" href="classamrex_1_1BCRec.html" title="Boundary Condition Records. Necessary information and functions for computing boundary conditions.">BCRec</a> specifying physical boundary types </td></tr>
    <tr><td class="paramname">bcscomp</td><td>starting component of the <a class="el" href="classamrex_1_1BCRec.html" title="Boundary Condition Records. Necessary information and functions for computing boundary conditions.">BCRec</a> <a class="el" href="classamrex_1_1Vector.html" title="This class is a thin wrapper around std::vector. Unlike vector, Vector::operator[] provides bound che...">Vector</a>. </td></tr>
    <tr><td class="paramname">pre_interp</td><td>optional pre-interpolation hook for modifying the coarse data </td></tr>
    <tr><td class="paramname">post_interp</td><td>optional post-interpolation hook for modifying the fine data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa756e7fa531116007159b132f0312577" name="aa756e7fa531116007159b132f0312577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa756e7fa531116007159b132f0312577">&#9670;&#160;</a></span>fillRK()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MF &gt; </div>
<div class="memtemplate">
template&lt;typename BC &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classamrex_1_1FillPatcher.html">amrex::FillPatcher</a>&lt; MF &gt;::fillRK </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncycle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MF &amp;&#160;</td>
          <td class="paramname"><em>mf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a>&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BC &amp;&#160;</td>
          <td class="paramname"><em>cbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BC &amp;&#160;</td>
          <td class="paramname"><em>fbc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1Vector.html">Vector</a>&lt; <a class="el" href="classamrex_1_1BCRec.html">BCRec</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>bcs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill ghost cells of fine AMR level for RK3 and RK4. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stage</td><td>RK stage number starting from 1 </td></tr>
    <tr><td class="paramname">iteration</td><td>iteration number on fine level during a coarse time step. For an AMR simulation with subcycling and a refinement ratio of 2, the number is either 1 or 2, denoting the first and second substep, respectively. </td></tr>
    <tr><td class="paramname">ncycle</td><td>number of subcyling steps. It's usually 2 or 4. Without subcycling, this will be 1. </td></tr>
    <tr><td class="paramname">mf</td><td>destination MF </td></tr>
    <tr><td class="paramname">time</td><td>time associated with the coarse data </td></tr>
    <tr><td class="paramname">cbc</td><td>filling physical boundary on coarse level </td></tr>
    <tr><td class="paramname">fbc</td><td>filling physical boundary on fine level </td></tr>
    <tr><td class="paramname">bcs</td><td>physical BC types </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad059e9960589afeff57d54307acd2dca" name="ad059e9960589afeff57d54307acd2dca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad059e9960589afeff57d54307acd2dca">&#9670;&#160;</a></span>storeRKCoarseData()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MF &gt; </div>
<div class="memtemplate">
template&lt;std::size_t order&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classamrex_1_1FillPatcher.html">amrex::FillPatcher</a>&lt; MF &gt;::storeRKCoarseData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a>&#160;</td>
          <td class="paramname"><em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__amrex__arithmetic__types.html#ga00d9113947d2ea92bbdbfe7db24d81f2">Real</a>&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MF const &amp;&#160;</td>
          <td class="paramname"><em>S_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__amrex__linear__containers.html#gafe930d74045516fece8591f173e57007">Array</a>&lt; MF, order &gt; const &amp;&#160;</td>
          <td class="paramname"><em>RK_k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store coarse AMR level data for RK3 and RK4. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">order</td><td>RK order. Must be 3 or 4. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time</td><td>time at the beginning of the step </td></tr>
    <tr><td class="paramname">dt</td><td>time step </td></tr>
    <tr><td class="paramname">S_old</td><td>data at time </td></tr>
    <tr><td class="paramname">RK_k</td><td>right-hand side at RK stages </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/amrex/amrex/Src/AmrCore/<a class="el" href="AMReX__FillPatcher_8H_source.html">AMReX_FillPatcher.H</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceamrex.html">amrex</a></li><li class="navelem"><a class="el" href="classamrex_1_1FillPatcher.html">FillPatcher</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
