<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>AMReX: amrex::CGSolver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMReX
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Types</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceamrex.html">amrex</a></li><li class="navelem"><a class="el" href="classamrex_1_1CGSolver.html">CGSolver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classamrex_1_1CGSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">amrex::CGSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A <a class="el" href="classamrex_1_1CGSolver.html" title="A CGSolver solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi...">CGSolver</a> solves the linear equation, L(phi)=rhs, for a <a class="el" href="classamrex_1_1LinOp.html" title="A LinOp is a virtual base class for general linear operators capable of acting on MultiFabs...">LinOp</a> L and MultiFabs rhs and phi, using the conjugate gradient algorithm, either vanilla, or preconditioned via a single V-cycle of multigrid.  
 <a href="classamrex_1_1CGSolver.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="AMReX__CGSolver_8H_source.html">AMReX_CGSolver.H</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a0c6d6797999b216f26492f170891497b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a> { <a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497ba43998d5e117bedcd91f4c6045307cba7">CG</a>, 
<a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497ba8fd738ffb49d5acea44dd92c4b58848b">BiCGStab</a>, 
<a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497ba0a1416b72079c6153fef58b96b62ca4b">CABiCGStab</a>, 
<a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497ba67402ec39dd3d352b4ad7f49a86a5765">CABiCGStabQuad</a>
 }</td></tr>
<tr class="separator:a0c6d6797999b216f26492f170891497b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae8bd9022532e30643d758bdc1cdc134b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ae8bd9022532e30643d758bdc1cdc134b">CGSolver</a> (<a class="el" href="classamrex_1_1LinOp.html">LinOp</a> &amp;_lp, bool _use_mg_precond=false, int _lev=0)</td></tr>
<tr class="memdesc:ae8bd9022532e30643d758bdc1cdc134b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Constructor.  <a href="#ae8bd9022532e30643d758bdc1cdc134b">More...</a><br /></td></tr>
<tr class="separator:ae8bd9022532e30643d758bdc1cdc134b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23837ba5a3ca129f5b342d7c5939c60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ac23837ba5a3ca129f5b342d7c5939c60">~CGSolver</a> ()</td></tr>
<tr class="memdesc:ac23837ba5a3ca129f5b342d7c5939c60"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Destructor.  <a href="#ac23837ba5a3ca129f5b342d7c5939c60">More...</a><br /></td></tr>
<tr class="separator:ac23837ba5a3ca129f5b342d7c5939c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf6cb65b8065fa1e9c7950e563cc75e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a3bf6cb65b8065fa1e9c7950e563cc75e">solve</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;solnL, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;rhsL, Real eps_rel=-1.0, Real eps_abs=-1.0, <a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a> bc_mode=<a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5dea2789f303c136a93263ed4b63ce83d29a">LinOp::Inhomogeneous_BC</a>)</td></tr>
<tr class="memdesc:a3bf6cb65b8065fa1e9c7950e563cc75e"><td class="mdescLeft">&#160;</td><td class="mdescRight">solve the system, Lp(solnL)=rhsL to relative err, tolerance RETURNS AN INT!!!! indicating success or failure. 0 means success 1 means failed for loss of precision 2 means iterations exceeded  <a href="#a3bf6cb65b8065fa1e9c7950e563cc75e">More...</a><br /></td></tr>
<tr class="separator:a3bf6cb65b8065fa1e9c7950e563cc75e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e09357a3c38ff240222cb8ef5cb356e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a3e09357a3c38ff240222cb8ef5cb356e">setMaxIter</a> (int _maxiter)</td></tr>
<tr class="memdesc:a3e09357a3c38ff240222cb8ef5cb356e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum allowed number of CG iterations.  <a href="#a3e09357a3c38ff240222cb8ef5cb356e">More...</a><br /></td></tr>
<tr class="separator:a3e09357a3c38ff240222cb8ef5cb356e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4249ed4e5a3677b7389c8fa04c945e1f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a4249ed4e5a3677b7389c8fa04c945e1f">getMaxIter</a> () const </td></tr>
<tr class="memdesc:a4249ed4e5a3677b7389c8fa04c945e1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get maximum allowed number of CG iterations.  <a href="#a4249ed4e5a3677b7389c8fa04c945e1f">More...</a><br /></td></tr>
<tr class="separator:a4249ed4e5a3677b7389c8fa04c945e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b3c9ec4e5525aa309642ff6ffd553e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a1b3c9ec4e5525aa309642ff6ffd553e6">setUseMGPrecond</a> (bool _use_mg_precond)</td></tr>
<tr class="memdesc:a1b3c9ec4e5525aa309642ff6ffd553e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set flag determining whether MG preconditioning is used.  <a href="#a1b3c9ec4e5525aa309642ff6ffd553e6">More...</a><br /></td></tr>
<tr class="separator:a1b3c9ec4e5525aa309642ff6ffd553e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf97787cf01f6b9f50466764a9509e2f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#abf97787cf01f6b9f50466764a9509e2f">getUseMGPrecond</a> () const </td></tr>
<tr class="memdesc:abf97787cf01f6b9f50466764a9509e2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get flag determining whether MG preconditioning is used.  <a href="#abf97787cf01f6b9f50466764a9509e2f">More...</a><br /></td></tr>
<tr class="separator:abf97787cf01f6b9f50466764a9509e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8821be0104058369172484d234662504"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a8821be0104058369172484d234662504">setCGSolver</a> (<a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a> s)</td></tr>
<tr class="separator:a8821be0104058369172484d234662504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e0106b7be1096ed5a4b0d860d92dff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a97e0106b7be1096ed5a4b0d860d92dff">getCGSolver</a> () const </td></tr>
<tr class="separator:a97e0106b7be1096ed5a4b0d860d92dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72946c75f6002480bae35a85b01636a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ad72946c75f6002480bae35a85b01636a">setVerbose</a> (int _verbose)</td></tr>
<tr class="memdesc:ad72946c75f6002480bae35a85b01636a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the verbosity value.  <a href="#ad72946c75f6002480bae35a85b01636a">More...</a><br /></td></tr>
<tr class="separator:ad72946c75f6002480bae35a85b01636a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5556fd7fe7cd6dfe9c3c034c9f6782ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a5556fd7fe7cd6dfe9c3c034c9f6782ff">getVerbose</a> () const </td></tr>
<tr class="memdesc:a5556fd7fe7cd6dfe9c3c034c9f6782ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the verbosity value.  <a href="#a5556fd7fe7cd6dfe9c3c034c9f6782ff">More...</a><br /></td></tr>
<tr class="separator:a5556fd7fe7cd6dfe9c3c034c9f6782ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a5e82c4f3f85cce31876ddfb44d15ab3b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a5e82c4f3f85cce31876ddfb44d15ab3b">solve_cg</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;solnL, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;rhsL, Real eps_rel, Real eps_abs, <a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a> bc_mode)</td></tr>
<tr class="separator:a5e82c4f3f85cce31876ddfb44d15ab3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45f1fd4dde5f4fc0956180759ba9b1c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ae45f1fd4dde5f4fc0956180759ba9b1c">solve_bicgstab</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;solnL, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;rhsL, Real eps_rel, Real eps_abs, <a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a> bc_mode)</td></tr>
<tr class="separator:ae45f1fd4dde5f4fc0956180759ba9b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f02a534abef5242b3368d1796fc457"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ad1f02a534abef5242b3368d1796fc457">solve_cabicgstab</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;solnL, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;rhsL, Real eps_rel, Real eps_abs, <a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a> bc_mode)</td></tr>
<tr class="separator:ad1f02a534abef5242b3368d1796fc457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab208c424f69fec07ecfef3e903c8746d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ab208c424f69fec07ecfef3e903c8746d">solve_cabicgstab_quad</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;solnL, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;rhsL, Real eps_rel, Real eps_abs, <a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a> bc_mode)</td></tr>
<tr class="separator:ab208c424f69fec07ecfef3e903c8746d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe010e61f83b4a929371e1f2a9c14942"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#abe010e61f83b4a929371e1f2a9c14942">jbb_precond</a> (<a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;sol, const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;rhs, int <a class="el" href="classamrex_1_1CGSolver.html#ae4774aae0b5bef8521ae5f3da0177645">lev</a>, <a class="el" href="classamrex_1_1LinOp.html">LinOp</a> &amp;<a class="el" href="classamrex_1_1CGSolver.html#a73021022eca627a55d4832d3805fe756">Lp</a>)</td></tr>
<tr class="separator:abe010e61f83b4a929371e1f2a9c14942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc42da262864a3bc99b2ba75c7338d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a7cc42da262864a3bc99b2ba75c7338d3">set_mg_precond</a> ()</td></tr>
<tr class="memdesc:a7cc42da262864a3bc99b2ba75c7338d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">if (use_mg_precond == 1) then define the <a class="el" href="classamrex_1_1MultiGrid.html" title="A MultiGrid solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi using a V...">MultiGrid</a> * mg_precond  <a href="#a7cc42da262864a3bc99b2ba75c7338d3">More...</a><br /></td></tr>
<tr class="separator:a7cc42da262864a3bc99b2ba75c7338d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:ae293d2469abae0334d86fcfd668bac15"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ae293d2469abae0334d86fcfd668bac15">Initialize</a> ()</td></tr>
<tr class="memdesc:ae293d2469abae0334d86fcfd668bac15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct work space, initialize parameters.  <a href="#ae293d2469abae0334d86fcfd668bac15">More...</a><br /></td></tr>
<tr class="separator:ae293d2469abae0334d86fcfd668bac15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0e6933477f998d7b870630e79b66b01"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ab0e6933477f998d7b870630e79b66b01">Finalize</a> ()</td></tr>
<tr class="separator:ab0e6933477f998d7b870630e79b66b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aca325b5d06e29897bb9e4aec580abbf8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#aca325b5d06e29897bb9e4aec580abbf8">CGSolver</a> (const <a class="el" href="classamrex_1_1CGSolver.html">CGSolver</a> &amp;)</td></tr>
<tr class="memdesc:aca325b5d06e29897bb9e4aec580abbf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable copy constructor and assignment operator.  <a href="#aca325b5d06e29897bb9e4aec580abbf8">More...</a><br /></td></tr>
<tr class="separator:aca325b5d06e29897bb9e4aec580abbf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2737939cbf60a13218a109161af88de1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1CGSolver.html">CGSolver</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a2737939cbf60a13218a109161af88de1">operator=</a> (const <a class="el" href="classamrex_1_1CGSolver.html">CGSolver</a> &amp;)</td></tr>
<tr class="separator:a2737939cbf60a13218a109161af88de1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a73021022eca627a55d4832d3805fe756"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1LinOp.html">LinOp</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a73021022eca627a55d4832d3805fe756">Lp</a></td></tr>
<tr class="memdesc:a73021022eca627a55d4832d3805fe756"><td class="mdescLeft">&#160;</td><td class="mdescRight">The data.  <a href="#a73021022eca627a55d4832d3805fe756">More...</a><br /></td></tr>
<tr class="separator:a73021022eca627a55d4832d3805fe756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a655aaf962c0f52e2d4d161281655e16d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1MultiGrid.html">MultiGrid</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a655aaf962c0f52e2d4d161281655e16d">mg_precond</a></td></tr>
<tr class="memdesc:a655aaf962c0f52e2d4d161281655e16d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classamrex_1_1MultiGrid.html" title="A MultiGrid solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi using a V...">MultiGrid</a> solver to be used as preconditioner.  <a href="#a655aaf962c0f52e2d4d161281655e16d">More...</a><br /></td></tr>
<tr class="separator:a655aaf962c0f52e2d4d161281655e16d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb7282f496f37601977ff04589c11cea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#abb7282f496f37601977ff04589c11cea">maxiter</a></td></tr>
<tr class="memdesc:abb7282f496f37601977ff04589c11cea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current maximum number of allowed iterations.  <a href="#abb7282f496f37601977ff04589c11cea">More...</a><br /></td></tr>
<tr class="separator:abb7282f496f37601977ff04589c11cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c6ea933bfe8b80b6081af4d5ea2cb6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ab4c6ea933bfe8b80b6081af4d5ea2cb6">verbose</a></td></tr>
<tr class="memdesc:ab4c6ea933bfe8b80b6081af4d5ea2cb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current verbosity level.  <a href="#ab4c6ea933bfe8b80b6081af4d5ea2cb6">More...</a><br /></td></tr>
<tr class="separator:ab4c6ea933bfe8b80b6081af4d5ea2cb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4774aae0b5bef8521ae5f3da0177645"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ae4774aae0b5bef8521ae5f3da0177645">lev</a></td></tr>
<tr class="memdesc:ae4774aae0b5bef8521ae5f3da0177645"><td class="mdescLeft">&#160;</td><td class="mdescRight">Level of the linear operator to use.  <a href="#ae4774aae0b5bef8521ae5f3da0177645">More...</a><br /></td></tr>
<tr class="separator:ae4774aae0b5bef8521ae5f3da0177645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e004fc32503bb70c471c87921ddfd94"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a1e004fc32503bb70c471c87921ddfd94">use_mg_precond</a></td></tr>
<tr class="memdesc:a1e004fc32503bb70c471c87921ddfd94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use multigrid as a preconditioner.  <a href="#a1e004fc32503bb70c471c87921ddfd94">More...</a><br /></td></tr>
<tr class="separator:a1e004fc32503bb70c471c87921ddfd94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af7811a9f5617ba318f3b37cc160718"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a4af7811a9f5617ba318f3b37cc160718">cg_solver</a></td></tr>
<tr class="separator:a4af7811a9f5617ba318f3b37cc160718"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:ac73f50084576b9ff6645d953240e4306"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ac73f50084576b9ff6645d953240e4306">def_maxiter</a></td></tr>
<tr class="separator:ac73f50084576b9ff6645d953240e4306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c04db60032c47766de992e4dcfec04c"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a8c04db60032c47766de992e4dcfec04c">def_unstable_criterion</a></td></tr>
<tr class="separator:a8c04db60032c47766de992e4dcfec04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a253d3fdcb79cdaf27d7f319a12fe0716"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#a253d3fdcb79cdaf27d7f319a12fe0716">def_verbose</a></td></tr>
<tr class="separator:a253d3fdcb79cdaf27d7f319a12fe0716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac678e8cb2630bc5f4719329594bd9c65"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ac678e8cb2630bc5f4719329594bd9c65">def_cg_solver</a></td></tr>
<tr class="separator:ac678e8cb2630bc5f4719329594bd9c65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae10a147ced123a9bd33004acf069e1f4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#ae10a147ced123a9bd33004acf069e1f4">use_jbb_precond</a></td></tr>
<tr class="memdesc:ae10a147ced123a9bd33004acf069e1f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use JBB's new method as a preconditioner.  <a href="#ae10a147ced123a9bd33004acf069e1f4">More...</a><br /></td></tr>
<tr class="separator:ae10a147ced123a9bd33004acf069e1f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd89ae4be0c4c6e3c89e4ca133942f4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamrex_1_1CGSolver.html#affd89ae4be0c4c6e3c89e4ca133942f4">use_jacobi_precond</a></td></tr>
<tr class="memdesc:affd89ae4be0c4c6e3c89e4ca133942f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use Jacobi smoothing as a preconditioner.  <a href="#affd89ae4be0c4c6e3c89e4ca133942f4">More...</a><br /></td></tr>
<tr class="separator:affd89ae4be0c4c6e3c89e4ca133942f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A <a class="el" href="classamrex_1_1CGSolver.html" title="A CGSolver solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi...">CGSolver</a> solves the linear equation, L(phi)=rhs, for a <a class="el" href="classamrex_1_1LinOp.html" title="A LinOp is a virtual base class for general linear operators capable of acting on MultiFabs...">LinOp</a> L and MultiFabs rhs and phi, using the conjugate gradient algorithm, either vanilla, or preconditioned via a single V-cycle of multigrid. </p>
<p>A <a class="el" href="classamrex_1_1CGSolver.html" title="A CGSolver solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi...">CGSolver</a> object solves the linear equation, L(phi)=rhs for a <a class="el" href="classamrex_1_1LinOp.html" title="A LinOp is a virtual base class for general linear operators capable of acting on MultiFabs...">LinOp</a> L, and MultiFabs phi and rhs. A <a class="el" href="classamrex_1_1CGSolver.html" title="A CGSolver solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi...">CGSolver</a> is constructed with a fully initialized 2D or 3D <a class="el" href="classamrex_1_1LinOp.html" title="A LinOp is a virtual base class for general linear operators capable of acting on MultiFabs...">LinOp</a>, and responds to "solve" requests of various signatures. The solve request (implicitly) includes a flag as to whether the system is to be solved with homogeneous boundary conditions or no. If homogeneous BCs are requested, all boundary information within the <a class="el" href="classamrex_1_1LinOp.html" title="A LinOp is a virtual base class for general linear operators capable of acting on MultiFabs...">LinOp</a> is used, except that the values of boundary FabSets are zeroed. The algorithm follows closely that described of p15 of the SIAM book, "Templates for the Solution of
    Linear Systems". Before solving a system, a small number of control parameters may be modified (maximum number of allowed iterations, reporting verbosity, etc). Also, either on construction or via member access functions, the user may choose to use a V-cycle 1-step <a class="el" href="classamrex_1_1MultiGrid.html" title="A MultiGrid solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi using a V...">MultiGrid</a> preconditioner within the CG loop by setting the appropriate bool flag (see members/ctrs below). The MG preconditioner used is just an instantiation of a <a class="el" href="classamrex_1_1MultiGrid.html" title="A MultiGrid solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi using a V...">MultiGrid</a> class object (the <a class="el" href="classamrex_1_1MultiGrid.html" title="A MultiGrid solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi using a V...">MultiGrid</a> class is documented separately).</p>
<p>Implementation Notes:</p>
<p>This algorithm implements solution of equations in a way that requires linearity of the operator. In "residual correction form", equations are solved only for the "correction" to the initial guess that is required to solve the desired system. In particular, boundary conditions are assumed to be satisfied after a single application of the linear operator (therefore, the correction is homogeneous at the boundary). As a result, after putting the problem in residual correction form, the entire system CG system has homigeneous boundary conditions. This solver therefore cannot incorporate fully nonlinear systems.</p>
<p>In general, a <a class="el" href="classamrex_1_1LinOp.html" title="A LinOp is a virtual base class for general linear operators capable of acting on MultiFabs...">LinOp</a> has the ability to apply high-order interpolation methods for computing boundary values. However, if the operator used in this <a class="el" href="classamrex_1_1CGSolver.html" title="A CGSolver solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi...">CGSolver</a> is non-symmetric, cg performance suffers tremendously. As a result, BC's should be applied with interpolants of order less than or equal to 2. We do not enforce this condition rigourously, since it would interfere with the user's definition of the operator. If cg performance is bad however, setting the <a class="el" href="classamrex_1_1LinOp.html" title="A LinOp is a virtual base class for general linear operators capable of acting on MultiFabs...">LinOp</a>'s maxorder=2 is a good place to start.</p>
<p><a class="el" href="classamrex_1_1CGSolver.html" title="A CGSolver solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi...">CGSolver</a> can fail to converge, or more likely diverge, if you run into a solvability problem (likely the accuracy cannot be achieved). <a class="el" href="classamrex_1_1CGSolver.html" title="A CGSolver solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi...">CGSolver</a> returns error codes 0 means good, 1&ndash;7 means loss-of-accuracy, 8 means iteration count exceeded. </p><pre class="fragment">Default settings:
The user has access to the following options in the cg algorithm:

maxiter(40) Maximum number of cg cycles allowed to solve the
system before abandoning

verbose(0) Verbosity (1-results, 2-progress, 3-detailed progress)

use_mg_precond(false) Whether to use the V-cycle multigrid
solver for the preconditioner system
</pre><p>unstable_criterion(10) if norm of residual grows by more than this factor, it is taken as signal that you've run into a solvability problem. </p><pre class="fragment">This class does NOT provide a copy constructor or assignment operator.</pre> </div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a0c6d6797999b216f26492f170891497b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">amrex::CGSolver::Solver</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a0c6d6797999b216f26492f170891497ba43998d5e117bedcd91f4c6045307cba7"></a>CG&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a0c6d6797999b216f26492f170891497ba8fd738ffb49d5acea44dd92c4b58848b"></a>BiCGStab&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a0c6d6797999b216f26492f170891497ba0a1416b72079c6153fef58b96b62ca4b"></a>CABiCGStab&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a0c6d6797999b216f26492f170891497ba67402ec39dd3d352b4ad7f49a86a5765"></a>CABiCGStabQuad&#160;</td><td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae8bd9022532e30643d758bdc1cdc134b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::CGSolver::CGSolver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1LinOp.html">LinOp</a> &amp;&#160;</td>
          <td class="paramname"><em>_lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>_use_mg_precond</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_lev</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_lp</td><td></td></tr>
    <tr><td class="paramname">_use_mg_precond</td><td></td></tr>
    <tr><td class="paramname">_lev</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac23837ba5a3ca129f5b342d7c5939c60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amrex::CGSolver::~CGSolver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Destructor. </p>

</div>
</div>
<a class="anchor" id="aca325b5d06e29897bb9e4aec580abbf8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">amrex::CGSolver::CGSolver </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1CGSolver.html">CGSolver</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disable copy constructor and assignment operator. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab0e6933477f998d7b870630e79b66b01"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::CGSolver::Finalize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a97e0106b7be1096ed5a4b0d860d92dff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a> amrex::CGSolver::getCGSolver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4249ed4e5a3677b7389c8fa04c945e1f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::getMaxIter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get maximum allowed number of CG iterations. </p>

</div>
</div>
<a class="anchor" id="abf97787cf01f6b9f50466764a9509e2f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::CGSolver::getUseMGPrecond </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get flag determining whether MG preconditioning is used. </p>

</div>
</div>
<a class="anchor" id="a5556fd7fe7cd6dfe9c3c034c9f6782ff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::getVerbose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the verbosity value. </p>

</div>
</div>
<a class="anchor" id="ae293d2469abae0334d86fcfd668bac15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::CGSolver::Initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct work space, initialize parameters. </p>

</div>
</div>
<a class="anchor" id="abe010e61f83b4a929371e1f2a9c14942"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::jbb_precond </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1LinOp.html">LinOp</a> &amp;&#160;</td>
          <td class="paramname"><em>Lp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2737939cbf60a13218a109161af88de1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1CGSolver.html">CGSolver</a>&amp; amrex::CGSolver::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1CGSolver.html">CGSolver</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7cc42da262864a3bc99b2ba75c7338d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::CGSolver::set_mg_precond </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>if (use_mg_precond == 1) then define the <a class="el" href="classamrex_1_1MultiGrid.html" title="A MultiGrid solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi using a V...">MultiGrid</a> * mg_precond </p>

</div>
</div>
<a class="anchor" id="a8821be0104058369172484d234662504"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::CGSolver::setCGSolver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a>&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3e09357a3c38ff240222cb8ef5cb356e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::CGSolver::setMaxIter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_maxiter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set maximum allowed number of CG iterations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_maxiter</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1b3c9ec4e5525aa309642ff6ffd553e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::CGSolver::setUseMGPrecond </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>_use_mg_precond</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set flag determining whether MG preconditioning is used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_use_mg_precond</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad72946c75f6002480bae35a85b01636a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void amrex::CGSolver::setVerbose </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the verbosity value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_verbose</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3bf6cb65b8065fa1e9c7950e563cc75e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>solnL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhsL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_rel</em> = <code>-1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_abs</em> = <code>-1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a>&#160;</td>
          <td class="paramname"><em>bc_mode</em> = <code><a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5dea2789f303c136a93263ed4b63ce83d29a">LinOp::Inhomogeneous_BC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>solve the system, Lp(solnL)=rhsL to relative err, tolerance RETURNS AN INT!!!! indicating success or failure. 0 means success 1 means failed for loss of precision 2 means iterations exceeded </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">solnL</td><td></td></tr>
    <tr><td class="paramname">rhsL</td><td></td></tr>
    <tr><td class="paramname">eps_rel</td><td></td></tr>
    <tr><td class="paramname">eps_abs</td><td></td></tr>
    <tr><td class="paramname">bc_mode</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae45f1fd4dde5f4fc0956180759ba9b1c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::solve_bicgstab </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>solnL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhsL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a>&#160;</td>
          <td class="paramname"><em>bc_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad1f02a534abef5242b3368d1796fc457"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::solve_cabicgstab </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>solnL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhsL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a>&#160;</td>
          <td class="paramname"><em>bc_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab208c424f69fec07ecfef3e903c8746d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::solve_cabicgstab_quad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>solnL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhsL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a>&#160;</td>
          <td class="paramname"><em>bc_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5e82c4f3f85cce31876ddfb44d15ab3b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::solve_cg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>solnL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classamrex_1_1MultiFab.html">MultiFab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhsL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>eps_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classamrex_1_1LinOp.html#ad5f2fc8009714c47dc63ff6a7a73a5de">LinOp::BC_Mode</a>&#160;</td>
          <td class="paramname"><em>bc_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4af7811a9f5617ba318f3b37cc160718"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">Solver</a> amrex::CGSolver::cg_solver</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac678e8cb2630bc5f4719329594bd9c65"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1CGSolver.html#a0c6d6797999b216f26492f170891497b">CGSolver::Solver</a> amrex::CGSolver::def_cg_solver</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac73f50084576b9ff6645d953240e4306"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::def_maxiter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a8c04db60032c47766de992e4dcfec04c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double amrex::CGSolver::def_unstable_criterion</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a253d3fdcb79cdaf27d7f319a12fe0716"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::def_verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae4774aae0b5bef8521ae5f3da0177645"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::lev</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Level of the linear operator to use. </p>

</div>
</div>
<a class="anchor" id="a73021022eca627a55d4832d3805fe756"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1LinOp.html">LinOp</a>&amp; amrex::CGSolver::Lp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The data. </p>
<p>Operator for linear system to be solved. </p>

</div>
</div>
<a class="anchor" id="abb7282f496f37601977ff04589c11cea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::maxiter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current maximum number of allowed iterations. </p>

</div>
</div>
<a class="anchor" id="a655aaf962c0f52e2d4d161281655e16d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classamrex_1_1MultiGrid.html">MultiGrid</a>* amrex::CGSolver::mg_precond</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classamrex_1_1MultiGrid.html" title="A MultiGrid solves the linear equation, L(phi)=rhs, for a LinOp L and MultiFabs rhs and phi using a V...">MultiGrid</a> solver to be used as preconditioner. </p>

</div>
</div>
<a class="anchor" id="affd89ae4be0c4c6e3c89e4ca133942f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::CGSolver::use_jacobi_precond</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use Jacobi smoothing as a preconditioner. </p>

</div>
</div>
<a class="anchor" id="ae10a147ced123a9bd33004acf069e1f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::CGSolver::use_jbb_precond</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use JBB's new method as a preconditioner. </p>

</div>
</div>
<a class="anchor" id="a1e004fc32503bb70c471c87921ddfd94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool amrex::CGSolver::use_mg_precond</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use multigrid as a preconditioner. </p>

</div>
</div>
<a class="anchor" id="ab4c6ea933bfe8b80b6081af4d5ea2cb6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int amrex::CGSolver::verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Current verbosity level. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/AMReX-Codes/amrex/Src/LinearSolvers/C_CellMG/<a class="el" href="AMReX__CGSolver_8H_source.html">AMReX_CGSolver.H</a></li>
<li>/home/travis/build/AMReX-Codes/amrex/Src/LinearSolvers/C_CellMG/<a class="el" href="AMReX__CGSolver_8cpp.html">AMReX_CGSolver.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
